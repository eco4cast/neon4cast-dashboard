---
title: "home"
---

Welcome the [EFI](https://ecoforecast.org) NEON Forecast Challenge Dashboard.

This site provides daily updates to visualize recent scores of all forecasts submitted to the challenge. This site is generated using [quarto](https://quarto.org) and should be simple to customize for users familiar with RMarkdown. It is rendered daily using GitHub Actions.

EFI currently has five open challenge themes! Browse the current forecasts or submit your own. Learn more about the [current challenges](https://projects.ecoforecast.org/neon4cast-docs).

### NEON Ecological Forecasting Challenge sites

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, include=FALSE)
```

```{r, setup}
library(ggiraph)
library(patchwork)
library(tidyverse)
library(neon4cast)
library(score4cast)
library(thematic)
thematic_rmd(bg="white", fg="black", accent="blue")
```

```{r}
library(sf)
library(tmap)
library(jsonlite)
library(dplyr)

if (!file.exists("neon.json")) {
  
  # scale by number of teams submitting forecast at a given site
  challenges <- 
    neon4cast::combined_scores(collect=FALSE) |>
    select(target_id, site_id, model_id) |>
    distinct() |>
    count(target_id, site_id) |> 
    collect()

  geo <- read_json("https://github.com/eco4cast/neon4cast/raw/main/inst/extdata/neon_geo.json", TRUE)
  site_id <- gsub(", .*$", "", geo$geographicDescription)
  bb <- geo$boundingCoordinates[1:4] |>
    mutate_all(as.numeric) |> 
    mutate(site_id = site_id)
  bb <- inner_join(bb, challenges, by = "site_id")
  neon <- st_as_sf(bb, 
                   coords = c("westBoundingCoordinate",
                              "northBoundingCoordinate"),
                   crs = 4326) |> 
    select(-eastBoundingCoordinate,
           -southBoundingCoordinate) |>
    rename(theme = target_id)
  #neon2 <- neon |>
  #  tidyr::pivot_wider(names_from = "theme", values_from = site_id) |> 
  #  rename(terrestrial = terrestrial_daily) |> 
  #  select(-terrestrial_30min) |> 
  #  st_as_sf()
  
  sf::st_write(neon, "neon.json", driver="GeoJSON")
} else {
  neon <- sf::st_read("neon.json")
}
```

```{r fig.height=5, fig.width=5, echo=FALSE, include=TRUE}
tmap::tmap_mode("view")
neon  |> filter(theme != "terrestrial_30min") |>
  tm_shape(bbox=c(-115,32,-74,48)) + 
  tm_bubbles(col="theme", size = "n", popup.vars = c("site_id", "n"), jitter =TRUE) 
```

Sites scaled by number of forecasts submitted.



---

This material is based upon work supported by the National Science Foundation under Grant DBI-1942280. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.
